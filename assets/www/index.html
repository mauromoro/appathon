<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
	<meta name="viewport" id="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximun-scale=1.0, user-scalable=no"/>
	<script type="text/javascript" charset="utf-8" src="js/cordova.js"></script>
	<script type="text/javascript" charset="utf-8" src="js/phonegap-nfc-0.2.0.js"></script>
	<link rel="stylesheet" href="css/jquery.mobile-1.4.2.css" />
	<script type="text/javascript" charset="utf-8" src="js/jquery-2.1.1.js"></script>
	<script type="text/javascript" charset="utf-8" src="js/jquery.mobile-1.4.2.js"></script>
	<script type="text/javascript" charset="utf-8">

		var devOn = false;
		var acc;
		var accOn = false;
		var accWatchID;
		var locWatchID;
		var accOptions = {frequency: 1000};
		var locOn = false;
		var lc;
		var LocOptions = {
			enableHighAccuracy: true,
			  //frequency: 1000,
			  maximunAge: 1000,
			  timeout: 3000
			};

			var com;
			var comOn = false;
			var comWatchID;
			var compassOptions = {frequency: 500};
			var username = "";

		  // wait for device API libraries to load
		  function onLoad(){
		  	document.addEventListener("deviceready",onDeviceReady,false);
		  }
		  // the event is fired when Cordova is fully loaded
		  function onDeviceReady(){
		    //navigator.notification.alert("PhoneGap is ready!");
			//
			dev = document.getElementById("appInfo");
			acc = document.getElementById("accInfo");
			lc = document.getElementById("locationInfo");
			com = document.getElementById("compass");
			//
			document.addEventListener("pause", onPause, false);
			document.addEventListener("resume", onResume, false);
			document.addEventListener("online", onOnline, false);
			document.addEventListener("offline", onOffline, false);
			document.addEventListener("backbutton", onBackbutton, false);
			document.addEventListener("menubutton", onMenuButton, false);
			//
			nfc.addNdefListener('onNfc', onNfcSuccess, onNfcFailure);
			//
			if (username != ""){
				$.mobile.navigate("#add");
			}
		}
		  // handle the online event
		  function onOnline() {
		  	navigator.notification.alert("onOnLine");
		  }
		  // handle the pause event
		  function onPause() {

		  	document.removeEventListener("pause", onPause, false);
		  	document.removeEventListener("resume", onResume, false);
		  	document.removeEventListener("offline", onOffLine, false);
		  	document.removeEventListener("backbutton", onBackButton, false);
		  	document.removeEventListener("menubutton", onMenuButton, false);

		  	navigator.notification.alert("onPause");
		  }
		  // handle the resume event
		  function onResume() {
		  	document.addEventListener("pause", onPause, false);
		  	document.addEventListener("resume", onResume, false);
		  	document.addEventListener("online", onOnline, false);
		  	document.addEventListener("offline", onOffline, false);
		  	document.addEventListener("backbutton", onBackbutton, false);
		  	document.addEventListener("menubutton", onMenuButton, false);

		  	navigator.notification.alert("onResume");
		  }
		  function onOffline() {
		  	navigator.notification.alert("onOffLine");
		  }
		  function onBackbutton() {
		  	navigator.notification.alert("onBackbutton");
		  }
		  function onMenuButton() {
		  	navigator.notification.alert("onMenuButton");
		  	$.mobile.navigate("#page1.nav-panel");


		  }
		  function getDev(){
		  	if (devOn){
		  		devOn = false;
		  		dev.innerHTML = "";
		  	} else {
		  		devOn = true;
		  		dev.innerHTML = "<hr>Ver: <strong>" + device.cordova + "</strong><br>" + 
		  		"Platform: <strong>" + device.platform + "</strong> - <strong>" + device.version +"</strong><br>" + 
		  		"Device: <strong>" + device.model + "</strong><br> UUID: <strong>" + device.uuid +"</strong><br>" +
		  		"Name: <strong>" + device.name + "</strong>";
		  	}
		  }
		  
		  function getAcc(){
		  	if (accOn) {
		  		accOn = false;
		  		navigator.accelerometer.clearWatch(accWatchID);
		  		acc.innerHTML = "";
		  	} else {
		  		accOn = true;
		  		accWatchID = navigator.accelerometer.watchAcceleration(onAccSuccess, onAccFailure, accOptions);
			  //navigator.accelerometer.getCurrentAcceleration(onAccSuccess, onAccFailure);
			}
			//navigator.notification.alert("onAccelerometer");
		}

		function onAccSuccess(accel) {

			acc.innerHTML = "<hr><b>X</b>= " + accel.x + "<br><b>Y</b>= " + accel.y + 
			"<br><b>Z</b>= " + accel.z;
			//navigator.notification.alert("onAccSuccess");
		}

		function onAccFailure() {
			navigator.notification.alert("onAccFailure");
		}

		function getCompass () {
			if (comOn) {
				comOn = false;
				navigator.compass.clearWatch(comWatchID);
				com.innerHTML= "";
			} else {
				comOn = true;
				comWatchID = navigator.compass.watchHeading(compassSuccess,compassFailure, compassOptions);
			}
			//navigator.notification.alert("getCompass()");
		}

		function compassSuccess(heading) {
		    //navigator.notification.alert("compasdSuccess()");
		    com.innerHTML = "<br><hr><b>Magnetic Heading</b>: " + heading.magneticHeading + "<br>" +
		    "<b>True Heading</b>: " + heading.trueHeading + "<br>" +
		    "<b>Heading Accuracy</b>: " + heading.headingAccuracy;
		    
		  }
		  
		  function compassFailure(compassError) {
		  	if (compassError.code == compassError.COMPASS_NOT_SUPPORTED) {
		  		com.innerHTML = "Compass not available.";
		  	} else if (compassError.code == compassError.COMPASS_INTERNAL_ERR) {
		  		navigator.notification.alert("Compass internal error!");
		  	} else {
		  		navigator.notification.alert("Unknown heading error!");
		  	}
		  }
		  
		  function getLocation(){
		  	if (locOn){
		  		locOn = false;
		  		navigator.geolocation.clearWatch(locWatchID);
		  		lc.innerHTML = "";
		  	} else {
		  		locOn = true;
		  		locWatchID = navigator.geolocation.watchPosition(onGeolocationSuccess, onGeolocationError);
		  	}
		    //navigator.geolocation.getCurrentPosition(onGeolocationSuccess, onGeolocationError);
			//navigator.notification.alert("onGeolocation");
		}

		function onGeolocationSuccess(loc){
			var d = new Date(loc.timestamp);
			
			lc.innerHTML = "<br><hr />" +
			"<b>Latitude</b>: " + loc.coords.latitude +
			"<br /><b>Longitude</b>: " + loc.coords.longitude +
			"<br /><b>Altitude</b>: " + loc.coords.altitude +
			"<br /><b>Accuracy</b>: " + loc.coords.accuracy +
			"<br /><b>Altitude Accuracy</b>: " + loc.coords.altitudeAccuracy +
			"<br /><b>Heading</b>: " + loc.coords.heading +
			"<br /><b>Speed</b>: " + loc.coords.speed +
			"<br /><b>Timestamp</b>: " + d.toLocaleString();
			//navigator.notification.alert("onLocationSuccess");
		}

		function onGeolocationError(e){
			var msgText = "Geolocation Error: #" + e.code + "\n" + e.message;
			lc.innerHTML = msgText;
		    //navigator.notification.alert(msgText);
		  }
		  
		  function exitApp(){
		  	navigator.app.exitApp();
		  }
		  
		  function login(){
		  	u = document.getElementById("name");
		  	u1 = document.getElementById("user");
		  	username = u.value;
		  	u1.innerHTML = username;

		  	cc = document.getElementById("cc");
		  	cc.innerHTML = "<br>C/C#1234567<hr>";
		  }
		  
		  $(document).on('click', '.transfer-money', function(){
		  	$('#page-3-box').toggleClass('hide');
		  })

		  $(document).on('click', '.nfc-button', function(){
		  	$('.coupon-box').addClass('hide');
		  	$('.ibeacon-box').addClass('hide');
		  	$('.nfc-box').toggleClass('hide');
		  })

		  $(document).on('click', '.ibeacon-button', function(){
		  	$('.nfc-box').addClass('hide');
		  	$('.coupon-box').addClass('hide');
		  	$('.ibeacon-box').toggleClass('hide');
		  })

		  $(document).on('click', '.coupon-button', function(){
		  	$('.ibeacon-box').addClass('hide');
		  	$('.nfc-box').addClass('hide');		  	
		  	$('.coupon-box').toggleClass('hide');
		  })

		  $(document).on('click', '.nfc-box-submit', function(){
		  	$('.feedback-money').removeClass('hide');
		  	$('.feedback-text').text('Avvicina il device');
		  	setTimeout(function() {
		  		$('.feedback-text').text('Toccato!');
		  		setTimeout(function() {
		  			$('.feedback-text').text('Pagamento effettuato');
			  		setTimeout(function() {
			  			$('.feedback-money').addClass('hide');
						}, 1000);		  			
					}, 1000);
				}, 2000);
		  })

      $(document).on('click', '#wishlist1', function () {
          $('#wishes').hide("slow");
          $('#wishlist1').hide();
          $('#wishlist2').show();
      })

      $(document).on('click', '#wishlist2', function () {
          $('#wishes').show("slow");
          $('#wishlist2').hide();
          $('#wishlist1').show();
      })
		</script>
	</head>
	<body onload="onLoad()">

		<!-- page -->
		<div data-role="page" id="page1">

			<div data-role="header" data-position="fixed">
				<h1>Panoramica</h1>
				<a href="#nav-panel" data-icon="bars" data-iconpos="notext">Menu</a>
				<a href="#add" data-icon="gear" data-iconpos="notext">Add</a>
			</div>

			<div role="main" class="ui_content">

			  <div>
			    <img id="unicredit" style="position:relative; top:50%; left:35%" src="img/LogoUnicredit-3.png"/>
			  </div>
				
			  <div id="userdiv" data-role="collapsible" data-collapsed="false" data-iconpos="right">
				<h4 id="user">Utente</h4>
				<p> I'm the collapside content. By default I'm closed, but youcan click the header to open me.</p>
			  </div>
			  
			  <div id="accountdiv" data-role="collapsible" data-collapsed="false" data-iconpos="right">
				<h4 id="account">Conto</h4>
				<p> I'm the collapside content. By default I'm closed, but youcan click the header to open me.</p>
			  </div>
			  
			  <div id="carddiv" data-role="collapsible" data-collapsed="false" data-iconpos="right">
				<h4 id="cards">Carte</h4>
				<img id="unicredit" src="img/LogoUnicredit-3.png"/>
				<p> I'm the collapside content. By default I'm closed, but youcan click the header to open me.</p>
			  </div>
			  
			  <div id="assetsdiv" data-role="collapsible" data-collapsed="false" data-iconpos="right">
				<h4 id="assets">Investimenti</h4>
				<p> I'm the collapside content. By default I'm closed, but youcan click the header to open me.</p>
			  </div>
			</div>

			<div data-role="footer" data-position="fixed">
			  <a href="#" data-icon="power" data-iconpos="notext" class="ui-btn-right" onclick="navigator.app.exitApp();"></a>
			  <p style="text-align:center">Appathon 2014</p>
			</div>

			<!-- panel -->
			<div data-role="panel" id="nav-panel" data-position="left" data-display="push" data-position-fixed="true">
				<ul data-role="listview">
					<li data-icon="delete">
						<a href="#" data-rel="close">Close menu</a>
					</li>
					<li>
						<a href="">Panoramica</a>
					</li>
					<li>
						<a href="#page2">WishList</a>
					</li>
					<li>
						<a href="#page3">Moneta Elettronica</a>
					</li>
					<li>
						<a href="#page4">Notifiche</a>
					</li>						
				</ul>
			</div>
	<!-- /panel -->

	<!-- panel -->
	<div data-role="panel" id="add" data-position="right" data-display="overlay" data-position-fixed="true">
		<form class="userform">
			<h2>Login</h2>
			<label for="name">Username:</label>
			<input type="text" name="name" id="name" value="" data-clear-btn="true" data-mini="true">
			<label for="password">Password:</label>
			<input type="password" name="password" id="password" value="" data-clear-btn="true" autocomplete="off" data-mini="true">
			<div class="ui-grid-a">
				<div class="ui-block-a">
					<a href="#" data-rel="close" class="ui-btn ui-shadow ui-corner-all ui-btn-b ui-mini">Close</a>
				</div>
				<div class="ui-block-b">
					<a href="#" data-rel="close" class="ui-btn ui-shadow ui-corner-all ui-btn-a ui-mini" onclick="login();">Save</a>
				</div>
			</div>
		</form>
	</div>
	<!-- /panel -->

</div>
<!-- /page -->

<!-- page2 -->
<div data-role="page" id="page2">
	<div data-role="header" data-position="fixed">
		<h1>WishList</h1>
		<a href="#nav-panel" data-icon="bars" data-iconpos="notext">Menu</a>
		<a href="#add" data-icon="gear" data-iconpos="notext">Add</a>
	</div>

	<div role="main" class="ui_content">
     <div id="grafico" style="width: 100%; height: 400px; border: double;">
          Qui ci sarà il grafico completo dei valori
     </div>

		<!-- Accordeon per la visualizzazione dei dettagli-->

    <div data-demo-html="true">
        <div data-role="collapsible-set" data-inset="false">
            <div data-role="collapsible">
                <h3>Accrediti</h3>
                <ul data-role="listview" data-inset="false">
                    <li>Bonifico SEPA</li>
                    <li>Bonifico SEPA</li>
                    <li>Accredito interessi</li>
                </ul>
            </div>
            <div data-role="collapsible">
                <h3>Spese</h3>
                <ul data-role="listview" data-inset="false">
                    <li>Bolletta Telecom</li>
                    <li>ENI Bolletta</li>
                </ul>
            </div>
            <div data-role="collapsible">
                <h3>Risparmi wishlist</h3>
                <ul data-role="listview" data-inset="false">
                    <li>Earth</li>
                    <li>Jupiter</li>
                    <li>Mars</li>
                    <li>Mercury</li>
                </ul>
            </div>
        </div>
    </div>


    <div id="inputObiettivo" data-role="popup" data-transition="slideup" style="width: 300px; height: 300px;">
        <label for="importoPrevisto">Importo previsto</label>
        <input id="importoPrevisto" name="importoPrevisto" type="text" />
        <label for="dataObiettivo">Data obiettivo</label>
        <input id="dataObiettivo" name="dataObiettivo" type="text" />
        <input id="confermaObiettivo" type="button" value="Conferma" />
    </div>

    <div id="selector" style="height: 100px;">
        <table>
            <tr>
                <td width="100px">
                    <a href="#" id="wishlist1" data-role="button" style="width: 100px; ">WISHLIST</a>
                    <a href="#" id="wishlist2" data-role="button" style="width: 100px; display: none;">WISHLIST</a>
                </td>
                <td>
                    <div id="wishes" data-transition="slide">
                        <table>
                            <tr>
                                <td>
                                    <a href="#inputObiettivo" data-rel="popup" data-role="button">H</a>
                                </td>
                                <td>
                                    <a href="#inputObiettivo" data-rel="popup" data-role="button">€</a>
                                </td>
                                <td>
                                    <a href="#inputObiettivo" data-rel="popup" data-role="button">C</a>
                                </td>
                                <td>
                                    <a href="#inputObiettivo" data-rel="popup" data-role="button">I</a>
                                </td>
                                </tr>
                            </table>
                    </div>
            </td>
            </tr>
        </table>
    </div>
	</div>

	<div data-role="footer" data-position="fixed">
	  <a href="#" data-icon="power" data-iconpos="notext" class="ui-btn-right" onclick="navigator.app.exitApp();"></a>
	  <p style="text-align:center">Appathon 2014</p>
	</div>

	<!-- panel -->
	<div data-role="panel" id="nav-panel" data-position="left" data-display="push" data-position-fixed="true">
		<ul data-role="listview">
			<li data-icon="delete">
				<a href="#" data-rel="close">Close menu</a>
			</li>
			<li>
				<a href="#page1">Panoramica</a>
			</li>
			<li>
				<a href="">WishList</a>
			</li>
			<li>
				<a href="#page3">Moneta Elettronica</a>
			</li>
			<li>
				<a href="#page4">Notifiche</a>
			</li>				
		</ul>
	</div>
	<!-- /panel -->

	<!-- panel -->
	<div data-role="panel" id="add" data-position="right" data-display="overlay" data-position-fixed="true">
		<form class="userform">
			<h2>Login</h2>
			<label for="name">Username:</label>
			<input type="text" name="name" id="name" value="" data-clear-btn="true" data-mini="true">
			<label for="password">Password:</label>
			<input type="password" name="password" id="password" value="" data-clear-btn="true" autocomplete="off" data-mini="true">
			<div class="ui-grid-a">
				<div class="ui-block-a">
					<a href="#" data-rel="close" class="ui-btn ui-shadow ui-corner-all ui-btn-b ui-mini">Close</a>
				</div>
				<div class="ui-block-b">
					<a href="#" data-rel="close" class="ui-btn ui-shadow ui-corner-all ui-btn-a ui-mini" onclick="login();">Save</a>
				</div>
			</div>
		</form>
	</div>
	<!-- /panel -->
</div>
<!-- /page2 -->

<!-- page3 -->
<div data-role="page" id="page3">

	<div data-role="header" data-position="fixed">
		<h1>MONETA DIGITALE</h1>
		<a href="#nav-panel" data-icon="bars" data-iconpos="notext">Menu</a>
		<a href="#add" data-icon="gear" data-iconpos="notext">Add</a>
	</div>

	<div role="main" class="ui_content page-2">
		<button class="transfer-money">TRASFERISCI DENARO</button>
		<div id="page-3-box" class="main-box hide">
			<button class="nfc-button">NFC</button>
			<button class="ibeacon-button">iBeacon</button>
			<button class="coupon-button">Emetti Coupon</button>

			<div class="nfc-box hide">
				<input class="nfc-box-input input" type="number" placeholder="importo">
				<button class="nfc-box-submit submit">INVIA DENARO TRAMITE NFC</button>
			</div>
			<div class="ibeacon-box hide">
				<input class="ibeacon-box-input input" type="number" placeholder="importo">
				<button class="ibeacon-box-submit submit">INVIA DENARO TRAMITE IBEACON</button>			
			</div>
			<div class="coupon-box hide">
				<input class="coupon-box-input input" type="number" placeholder="importo">
				<button class="coupon-box-submit submit">INVIA DENARO TRAMITE COUPON</button>
			</div>
			<div class="feedback-money hide">
				<label class="feedback-text"></label>
			</div>
		</div>
	</div>

		<div data-role="footer" data-position="fixed">
		  <a href="#" data-icon="power" data-iconpos="notext" class="ui-btn-right" onclick="navigator.app.exitApp();"></a>
		  <p style="text-align:center">Appathon 2014</p>
		</div>
			<!-- panel -->
			<div data-role="panel" id="nav-panel" data-position="left" data-display="push" data-position-fixed="true">
				<ul data-role="listview">
					<li data-icon="delete">
						<a href="#" data-rel="close">Close menu</a>
					</li>
					<li>
						<a href="#page1">Panoramica</a>
					</li>
					<li>
						<a href="#page2">WishList</a>
					</li>
					<li>
						<a href="">Moneta Elettronica</a>
					</li>
					<li>
						<a href="#page4">Notifiche</a>
					</li>						
				</ul>
			</div>
	<!-- /panel -->

	<!-- panel -->
	<div data-role="panel" id="add" data-position="right" data-display="overlay" data-position-fixed="true">
		<form class="userform">
			<h2>Login</h2>
			<label for="name">Username:</label>
			<input type="text" name="name" id="name" value="" data-clear-btn="true" data-mini="true">
			<label for="password">Password:</label>
			<input type="password" name="password" id="password" value="" data-clear-btn="true" autocomplete="off" data-mini="true">
			<div class="ui-grid-a">
				<div class="ui-block-a">
					<a href="#" data-rel="close" class="ui-btn ui-shadow ui-corner-all ui-btn-b ui-mini">Close</a>
				</div>
				<div class="ui-block-b">
					<a href="#" data-rel="close" class="ui-btn ui-shadow ui-corner-all ui-btn-a ui-mini" onclick="login();">Save</a>
				</div>
			</div>
		</form>
	</div>
	<!-- /panel -->
</div>
<!-- /page3 -->

<!-- page3 -->
<div data-role="page" id="page4">

	<div data-role="header" data-position="fixed">
		<h1>NOTIFICHE</h1>
		<a href="#nav-panel" data-icon="bars" data-iconpos="notext">Menu</a>
		<a href="#add" data-icon="gear" data-iconpos="notext">Add</a>
	</div>

	<div role="main" class="ui_content page-2">
		<div id="page-4-box" class="main-box">
		 <ul data-role="listview">
		 	<div class="bank-notification">Occhio al portafoglio: cerca di ridurre le spese se vuoi arrivare a fine mese :)</div>
		 	<div class="bank-notification">Analizzando le tue spese, abbiamo trovato un offerta che potrebbe interessarti</div>
		 	<div class="bank-notification">Bravo, ti stai attinendo al piano risparmi ;)</div>
		 	<div class="bank-notification">Dai un' occhiata al tuo piano di risparmio, ci sono buone notizie per te.</div>
		 	<div class="bank-notification">Sapevi che puoi trasferire denaro direttamente dall'app in modo instantaneo?</div>
		 	<div class="bank-notification">Grazie al tuo piano risparmio, hai risparmiato finora circa 500€ in 5 mesi!</div>
		 </ul>
		</div>
	</div>

	<div data-role="footer" data-position="fixed">
	  <a href="#" data-icon="power" data-iconpos="notext" class="ui-btn-right" onclick="navigator.app.exitApp();"></a>
	  <p style="text-align:center">Appathon 2014</p>
	</div>
			<!-- panel -->
			<div data-role="panel" id="nav-panel" data-position="left" data-display="push" data-position-fixed="true">
				<ul data-role="listview">
					<li data-icon="delete">
						<a href="#" data-rel="close">Close menu</a>
					</li>
					<li>
						<a href="#page1">Panoramica</a>
					</li>
					<li>
						<a href="#page2">WishList</a>
					</li>
					<li>
						<a href="#page3">Moneta Elettronica</a>
					</li>
					<li>
						<a href="">Notifiche</a>
					</li>					
				</ul>
			</div>
	<!-- /panel -->

	<!-- panel -->
	<div data-role="panel" id="add" data-position="right" data-display="overlay" data-position-fixed="true">
		<form class="userform">
			<h2>Login</h2>
			<label for="name">Username:</label>
			<input type="text" name="name" id="name" value="" data-clear-btn="true" data-mini="true">
			<label for="password">Password:</label>
			<input type="password" name="password" id="password" value="" data-clear-btn="true" autocomplete="off" data-mini="true">
			<div class="ui-grid-a">
				<div class="ui-block-a">
					<a href="#" data-rel="close" class="ui-btn ui-shadow ui-corner-all ui-btn-b ui-mini">Close</a>
				</div>
				<div class="ui-block-b">
					<a href="#" data-rel="close" class="ui-btn ui-shadow ui-corner-all ui-btn-a ui-mini" onclick="login();">Save</a>
				</div>
			</div>
		</form>
	</div>
	<!-- /panel -->
</div>
<!-- /page3 -->

</body>
</html>
<style>
	.page-2{
		margin: 20px;
	}
	.hide{
		display: none;
	}
	.transfer-money{
		margin: 20px 0px;
	}
	#page-3-box{
		padding: 20px;
	}
	.coupon-box, .nfc-box, .ibeacon-box{
		padding: 40px;
	}

	.ui-panel-wrapper{
		border: none !important;
	}
	.feedback-text{
		text-align: center;
	}
	li{
		text-align: center !important;
	}
	.bank-notification{
		padding: 5px;
		border-bottom: 1px solid;
		margin: 14px 0;
	}

</style>
